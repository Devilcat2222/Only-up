<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Only Up Game</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; }
        #instructions {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-family: Arial, sans-serif;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div id="instructions">
        <p>Controls:</p>
        <p>WASD - Move</p>
        <p>Space - Jump</p>
        <p>Mouse - Look around</p>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/PointerLockControls.js"></script>
    <script>
        // Scene setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87ceeb);
        scene.fog = new THREE.Fog(0x87ceeb, 10, 50);

        // Camera
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 2, 0);

        // Renderer
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // PointerLockControls for smooth first-person movement
        const controls = new THREE.PointerLockControls(camera, document.body);
        document.addEventListener('click', () => controls.lock());

        // Player physics
        const player = {
            velocity: new THREE.Vector3(),
            position: camera.position,
            height: 1.8,
            speed: 0.1,
            jumpForce: 0.2,
            gravity: -0.005,
            isGrounded: false
        };

        // Keyboard controls
        const keys = {};
        document.addEventListener('keydown', (e) => keys[e.code] = true);
        document.addEventListener('keyup', (e) => keys[e.code] = false);

        // Platforms
        const platforms = [];
        const platformMaterial = new THREE.MeshStandardMaterial({ color: 0x888888 });
        function createPlatform(x, y, z, width, depth) {
            const geometry = new THREE.BoxGeometry(width, 0.5, depth);
            const platform = new THREE.Mesh(geometry, platformMaterial);
            platform.position.set(x, y, z);
            scene.add(platform);
            platforms.push(platform);
        }

        // Create multiple platforms
        createPlatform(0, 0, 0, 10, 10); // Starting platform
        createPlatform(5, 2, -5, 5, 5);
        createPlatform(10, 4, -10, 5, 5);
        createPlatform(15, 6, -15, 5, 5);
        createPlatform(20, 8, -20, 5, 5);

        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
        directionalLight.position.set(10, 20, 10);
        scene.add(directionalLight);

        // Collision detection
        function checkCollision() {
            const playerBox = new THREE.Box3().setFromCenterAndSize(
                player.position,
                new THREE.Vector3(0.5, player.height, 0.5)
            );

            for (const platform of platforms) {
                const platformBox = new THREE.Box3().setFromObject(platform);
                if (playerBox.intersectsBox(platformBox)) {
                    const platformTop = platform.position.y + 0.25;
                    if (player.position.y > platformTop) {
                        player.position.y = platformTop + player.height / 2;
                        player.velocity.y = 0;
                        player.isGrounded = true;
                        return true;
                    }
                }
            }
            return false;
        }

        // Movement and physics update
        function update() {
            // Apply gravity
            player.velocity.y += player.gravity;

            // Movement
            const direction = new THREE.Vector3();
            if (keys['KeyS']) direction.z -= 1;
            if (keys['KeyW']) direction.z += 1;
            if (keys['KeyA']) direction.x -= 1;
            if (keys['KeyD']) direction.x += 1;

            // Normalize and apply speed
            direction.normalize().multiplyScalar(player.speed);
            const forward = new THREE.Vector3();
            controls.getDirection(forward);
            const right = new THREE.Vector3().crossVectors(forward, new THREE.Vector3(0, 1, 0));
            player.velocity.x = direction.x * right.x + direction.z * forward.x;
            player.velocity.z = direction.x * right.z + direction.z * forward.z;

            // Jump
            if (keys['Space'] && player.isGrounded) {
                player.velocity.y = player.jumpForce;
                player.isGrounded = false;
            }

            // Update position
            player.position.add(player.velocity);

            // Check collisions
            if (!checkCollision() && player.velocity.y < 0) {
                player.isGrounded = false;
            }

            // Prevent falling below ground
            if (player.position.y < -10) {
                player.position.set(0, 2, 0);
                player.velocity.set(0, 0, 0);
                player.isGrounded = true;
            }

            // Smooth damping
            player.velocity.x *= 0.9;
            player.velocity.z *= 0.9;
        }

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            update();
            renderer.render(scene, camera);
        }
        animate();

        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
